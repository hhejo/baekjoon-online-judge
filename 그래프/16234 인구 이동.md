# [16234 ì¸êµ¬ ì´ë™](https://www.acmicpc.net/problem/16234)

### ğŸ¥‡ 5

### ë¶„ë¥˜

- êµ¬í˜„
- ê·¸ë˜í”„ ì´ë¡ 
- ê·¸ë˜í”„ íƒìƒ‰
- ë„ˆë¹„ ìš°ì„  íƒìƒ‰
- ì‹œë®¬ë ˆì´ì…˜

### í’€ì´ ë‚ ì§œ

- 230404 í™”

---

## CODE

```python
import sys

input = sys.stdin.readline


def move_population(v, dic):
    global N, g
    for x in range(N):
        for y in range(N):
            if v[x][y]:
                g[x][y] = dic[v[x][y]]
    return


def dfs(sx, sy, v, union):
    global N, L, R, g, dx, dy
    stk = [(sx, sy)]
    v[sx][sy] = union
    cnt = 0
    acc = 0
    while stk:
        cx, cy = stk.pop()
        cnt += 1
        acc += g[cx][cy]
        for i in range(4):
            nx, ny = cx + dx[i], cy + dy[i]
            if 0 <= nx < N and 0 <= ny < N and L <= abs(g[cx][cy] - g[nx][ny]) <= R and not v[nx][ny]:
                stk.append((nx, ny))
                v[nx][ny] = union
    return acc // cnt


def get_each_union_and_population(v):
    global N, L, R, g, union
    dic = {}
    for x in range(N):
        for y in range(N):
            for i in range(4):
                nx, ny = x + dx[i], y + dy[i]
                if 0 <= nx < N and 0 <= ny < N and L <= abs(g[x][y] - g[nx][ny]) <= R and not v[x][y]:
                    union += 1
                    avg = dfs(x, y, v, union)
                    dic[union] = avg
    return dic


N, L, R = map(int, input().split())
g = [list(map(int, input().split())) for _ in range(N)]

dx, dy = (-1, 0, 1, 0), (0, 1, 0, -1)
ans = 0

while True:
    union = 0
    v = [[0] * N for _ in range(N)]

    population_dic = get_each_union_and_population(v)

    if union == 0:
        break
    else:
        move_population(v, population_dic)
        ans += 1

print(ans)

```

## í•´ì„¤

ì¸êµ¬ ì´ë™ì„ í•  ìˆ˜ ì—†ë‹¤ë©´ ì—°í•©ì´ 0ê°œ ì´ë¯€ë¡œ ì¢…ë£Œ

ì¸êµ¬ ì´ë™ì„ í•  ìˆ˜ ìˆë‹¤ë©´ ì¸êµ¬ ì´ë™í•˜ê³  ì •ë‹µ 1 ëˆ„ì 

ë°©ë¬¸ ì—¬ë¶€ ë°°ì—´ì˜ ê° ì›ì†Œ ê°’ì´ ìì‹ ì´ ì†í•œ ì—°í•©ì˜ ë²ˆí˜¸

í˜„ì¬ ìœ„ì¹˜ì—ì„œ ì¸êµ¬ ì´ë™ì´ ê°€ëŠ¥í•˜ë©´ DFS ì§„í–‰í•˜ë©´ì„œ ì´ì–´ì§„ ëª¨ë“  ê°œìˆ˜ì™€ ê°’ë“¤ì„ ëˆ„ì í•˜ê³ , DFSê°€ ì¢…ë£Œë˜ë©´ ê·¸ ê°œìˆ˜ì™€ ëˆ„ì  ê°’ì„ ë”•ì…”ë„ˆë¦¬ì— `ì—°í•© ë²ˆí˜¸: ê°œìˆ˜ // ê°’` ìœ¼ë¡œ ì €ì¥í•´ ë‘ 

`31256KB`, `3524ms`

